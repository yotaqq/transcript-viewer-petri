{"version":3,"file":"transcript-cache-CC28Y9w0.js","sources":["../../../.svelte-kit/adapter-node/chunks/transcript-cache.js"],"sourcesContent":["import { promises } from \"fs\";\nimport path from \"path\";\nimport { watch } from \"chokidar\";\nimport { EventEmitter } from \"events\";\nimport Ajv from \"ajv\";\nimport addFormats from \"ajv-formats\";\nimport { b as createTranscriptDisplay } from \"./transcript-utils.js\";\nimport { a as DEFAULT_TRANSCRIPT_DIR } from \"./constants.js\";\nconst $defs = /* @__PURE__ */ JSON.parse('{\"AddMessage\":{\"description\":\"Edit that adds a message to the transcript.\",\"properties\":{\"operation\":{\"const\":\"add\",\"default\":\"add\",\"title\":\"Operation\",\"type\":\"string\"},\"message\":{\"discriminator\":{\"mapping\":{\"assistant\":\"#/$defs/ChatMessageAssistant\",\"system\":\"#/$defs/ChatMessageSystem\",\"tool\":\"#/$defs/ChatMessageTool\",\"user\":\"#/$defs/ChatMessageUser\"},\"propertyName\":\"role\"},\"oneOf\":[{\"$ref\":\"#/$defs/ChatMessageSystem\"},{\"$ref\":\"#/$defs/ChatMessageUser\"},{\"$ref\":\"#/$defs/ChatMessageAssistant\"},{\"$ref\":\"#/$defs/ChatMessageTool\"}],\"title\":\"Message\"}},\"required\":[\"message\"],\"title\":\"AddMessage\",\"type\":\"object\"},\"ChatMessageAssistant\":{\"description\":\"Assistant chat message.\",\"properties\":{\"id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Id\"},\"content\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"anyOf\":[{\"$ref\":\"#/$defs/ContentText\"},{\"$ref\":\"#/$defs/ContentReasoning\"},{\"$ref\":\"#/$defs/ContentImage\"},{\"$ref\":\"#/$defs/ContentAudio\"},{\"$ref\":\"#/$defs/ContentVideo\"},{\"$ref\":\"#/$defs/ContentData\"},{\"$ref\":\"#/$defs/ContentToolUse\"},{\"$ref\":\"#/$defs/ContentDocument\"}]},\"type\":\"array\"}],\"title\":\"Content\"},\"source\":{\"anyOf\":[{\"enum\":[\"input\",\"generate\"],\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Source\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Metadata\"},\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"role\":{\"const\":\"assistant\",\"default\":\"assistant\",\"title\":\"Role\",\"type\":\"string\"},\"tool_calls\":{\"anyOf\":[{\"items\":{\"$ref\":\"#/$defs/ToolCall\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Tool Calls\"},\"model\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Model\"}},\"required\":[\"content\"],\"title\":\"ChatMessageAssistant\",\"type\":\"object\"},\"ChatMessageSystem\":{\"description\":\"System chat message.\",\"properties\":{\"id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Id\"},\"content\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"anyOf\":[{\"$ref\":\"#/$defs/ContentText\"},{\"$ref\":\"#/$defs/ContentReasoning\"},{\"$ref\":\"#/$defs/ContentImage\"},{\"$ref\":\"#/$defs/ContentAudio\"},{\"$ref\":\"#/$defs/ContentVideo\"},{\"$ref\":\"#/$defs/ContentData\"},{\"$ref\":\"#/$defs/ContentToolUse\"},{\"$ref\":\"#/$defs/ContentDocument\"}]},\"type\":\"array\"}],\"title\":\"Content\"},\"source\":{\"anyOf\":[{\"enum\":[\"input\",\"generate\"],\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Source\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Metadata\"},\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"role\":{\"const\":\"system\",\"default\":\"system\",\"title\":\"Role\",\"type\":\"string\"}},\"required\":[\"content\"],\"title\":\"ChatMessageSystem\",\"type\":\"object\"},\"ChatMessageTool\":{\"description\":\"Tool chat message.\",\"properties\":{\"id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Id\"},\"content\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"anyOf\":[{\"$ref\":\"#/$defs/ContentText\"},{\"$ref\":\"#/$defs/ContentReasoning\"},{\"$ref\":\"#/$defs/ContentImage\"},{\"$ref\":\"#/$defs/ContentAudio\"},{\"$ref\":\"#/$defs/ContentVideo\"},{\"$ref\":\"#/$defs/ContentData\"},{\"$ref\":\"#/$defs/ContentToolUse\"},{\"$ref\":\"#/$defs/ContentDocument\"}]},\"type\":\"array\"}],\"title\":\"Content\"},\"source\":{\"anyOf\":[{\"enum\":[\"input\",\"generate\"],\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Source\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Metadata\"},\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"role\":{\"const\":\"tool\",\"default\":\"tool\",\"title\":\"Role\",\"type\":\"string\"},\"tool_call_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Tool Call Id\"},\"function\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Function\"},\"error\":{\"anyOf\":[{\"$ref\":\"#/$defs/ToolCallError\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"content\"],\"title\":\"ChatMessageTool\",\"type\":\"object\"},\"ChatMessageUser\":{\"description\":\"User chat message.\",\"properties\":{\"id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Id\"},\"content\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"anyOf\":[{\"$ref\":\"#/$defs/ContentText\"},{\"$ref\":\"#/$defs/ContentReasoning\"},{\"$ref\":\"#/$defs/ContentImage\"},{\"$ref\":\"#/$defs/ContentAudio\"},{\"$ref\":\"#/$defs/ContentVideo\"},{\"$ref\":\"#/$defs/ContentData\"},{\"$ref\":\"#/$defs/ContentToolUse\"},{\"$ref\":\"#/$defs/ContentDocument\"}]},\"type\":\"array\"}],\"title\":\"Content\"},\"source\":{\"anyOf\":[{\"enum\":[\"input\",\"generate\"],\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Source\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Metadata\"},\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"role\":{\"const\":\"user\",\"default\":\"user\",\"title\":\"Role\",\"type\":\"string\"},\"tool_call_id\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Tool Call Id\"}},\"required\":[\"content\"],\"title\":\"ChatMessageUser\",\"type\":\"object\"},\"ContentAudio\":{\"description\":\"Audio content.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"audio\",\"default\":\"audio\",\"title\":\"Type\",\"type\":\"string\"},\"audio\":{\"title\":\"Audio\",\"type\":\"string\"},\"format\":{\"enum\":[\"wav\",\"mp3\"],\"title\":\"Format\",\"type\":\"string\"}},\"required\":[\"audio\",\"format\"],\"title\":\"ContentAudio\",\"type\":\"object\"},\"ContentCitation\":{\"description\":\"A generic content citation.\",\"properties\":{\"cited_text\":{\"anyOf\":[{\"type\":\"string\"},{\"additionalItems\":false,\"items\":[{\"type\":\"integer\"},{\"type\":\"integer\"}],\"maxItems\":2,\"minItems\":2,\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Cited Text\"},\"title\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Title\"},\"internal\":{\"anyOf\":[{\"additionalProperties\":{\"$ref\":\"#/$defs/JsonValue\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Internal\"},\"type\":{\"const\":\"content\",\"default\":\"content\",\"title\":\"Type\",\"type\":\"string\"}},\"title\":\"ContentCitation\",\"type\":\"object\"},\"ContentData\":{\"description\":\"Model internal.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"data\",\"default\":\"data\",\"title\":\"Type\",\"type\":\"string\"},\"data\":{\"additionalProperties\":{\"$ref\":\"#/$defs/JsonValue\"},\"title\":\"Data\",\"type\":\"object\"}},\"required\":[\"data\"],\"title\":\"ContentData\",\"type\":\"object\"},\"ContentDocument\":{\"description\":\"Document content (e.g. a PDF).\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"document\",\"default\":\"document\",\"title\":\"Type\",\"type\":\"string\"},\"document\":{\"title\":\"Document\",\"type\":\"string\"},\"filename\":{\"title\":\"Filename\",\"type\":\"string\"},\"mime_type\":{\"title\":\"Mime Type\",\"type\":\"string\"}},\"required\":[\"document\"],\"title\":\"ContentDocument\",\"type\":\"object\"},\"ContentImage\":{\"description\":\"Image content.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"image\",\"default\":\"image\",\"title\":\"Type\",\"type\":\"string\"},\"image\":{\"title\":\"Image\",\"type\":\"string\"},\"detail\":{\"default\":\"auto\",\"enum\":[\"auto\",\"low\",\"high\"],\"title\":\"Detail\",\"type\":\"string\"}},\"required\":[\"image\"],\"title\":\"ContentImage\",\"type\":\"object\"},\"ContentReasoning\":{\"description\":\"Reasoning content.\\\\n\\\\nSee the specification for [thinking blocks](https://docs.anthropic.com/en/docs/build-with-claude/extended-thinking#understanding-thinking-blocks) for Claude models.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"reasoning\",\"default\":\"reasoning\",\"title\":\"Type\",\"type\":\"string\"},\"reasoning\":{\"title\":\"Reasoning\",\"type\":\"string\"},\"signature\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Signature\"},\"redacted\":{\"default\":false,\"title\":\"Redacted\",\"type\":\"boolean\"}},\"required\":[\"reasoning\"],\"title\":\"ContentReasoning\",\"type\":\"object\"},\"ContentText\":{\"description\":\"Text content.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"text\",\"default\":\"text\",\"title\":\"Type\",\"type\":\"string\"},\"text\":{\"title\":\"Text\",\"type\":\"string\"},\"refusal\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Refusal\"},\"citations\":{\"anyOf\":[{\"items\":{\"discriminator\":{\"mapping\":{\"content\":\"#/$defs/ContentCitation\",\"document\":\"#/$defs/DocumentCitation\",\"url\":\"#/$defs/UrlCitation\"},\"propertyName\":\"type\"},\"oneOf\":[{\"$ref\":\"#/$defs/ContentCitation\"},{\"$ref\":\"#/$defs/DocumentCitation\"},{\"$ref\":\"#/$defs/UrlCitation\"}]},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Citations\"}},\"required\":[\"text\"],\"title\":\"ContentText\",\"type\":\"object\"},\"ContentToolUse\":{\"description\":\"Server side tool use.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"tool_use\",\"default\":\"tool_use\",\"title\":\"Type\",\"type\":\"string\"},\"tool_type\":{\"title\":\"Tool Type\",\"type\":\"string\"},\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"name\":{\"title\":\"Name\",\"type\":\"string\"},\"context\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Context\"},\"arguments\":{\"$ref\":\"#/$defs/JsonValue\"},\"result\":{\"$ref\":\"#/$defs/JsonValue\"},\"error\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Error\"}},\"required\":[\"tool_type\",\"id\",\"name\",\"arguments\",\"result\"],\"title\":\"ContentToolUse\",\"type\":\"object\"},\"ContentVideo\":{\"description\":\"Video content.\",\"properties\":{\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"const\":\"video\",\"default\":\"video\",\"title\":\"Type\",\"type\":\"string\"},\"video\":{\"title\":\"Video\",\"type\":\"string\"},\"format\":{\"enum\":[\"mp4\",\"mpeg\",\"mov\"],\"title\":\"Format\",\"type\":\"string\"}},\"required\":[\"video\",\"format\"],\"title\":\"ContentVideo\",\"type\":\"object\"},\"DecisionEvent\":{\"description\":\"Event that indicates a something non-deterministic has happened.\",\"properties\":{\"type\":{\"const\":\"decision_event\",\"default\":\"decision_event\",\"title\":\"Type\",\"type\":\"string\"},\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"title\":\"Metadata\"},\"timestamp\":{\"format\":\"date-time\",\"title\":\"Timestamp\",\"type\":\"string\"},\"content\":{\"title\":\"Content\"}},\"required\":[\"content\"],\"title\":\"DecisionEvent\",\"type\":\"object\"},\"DocumentCitation\":{\"description\":\"A citation that refers to a page range in a document.\",\"properties\":{\"cited_text\":{\"anyOf\":[{\"type\":\"string\"},{\"additionalItems\":false,\"items\":[{\"type\":\"integer\"},{\"type\":\"integer\"}],\"maxItems\":2,\"minItems\":2,\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Cited Text\"},\"title\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Title\"},\"internal\":{\"anyOf\":[{\"additionalProperties\":{\"$ref\":\"#/$defs/JsonValue\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Internal\"},\"type\":{\"const\":\"document\",\"default\":\"document\",\"title\":\"Type\",\"type\":\"string\"},\"range\":{\"anyOf\":[{\"$ref\":\"#/$defs/DocumentRange\"},{\"type\":\"null\"}],\"default\":null}},\"title\":\"DocumentCitation\",\"type\":\"object\"},\"DocumentRange\":{\"description\":\"A range specifying a section of a document.\",\"properties\":{\"type\":{\"enum\":[\"block\",\"page\",\"char\"],\"title\":\"Type\",\"type\":\"string\"},\"start_index\":{\"title\":\"Start Index\",\"type\":\"integer\"},\"end_index\":{\"title\":\"End Index\",\"type\":\"integer\"}},\"required\":[\"type\",\"start_index\",\"end_index\"],\"title\":\"DocumentRange\",\"type\":\"object\"},\"InfoEvent\":{\"description\":\"Event that adds information to the transcript.\",\"properties\":{\"type\":{\"const\":\"info_event\",\"default\":\"info_event\",\"title\":\"Type\",\"type\":\"string\"},\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"title\":\"Metadata\"},\"timestamp\":{\"format\":\"date-time\",\"title\":\"Timestamp\",\"type\":\"string\"},\"info\":{\"anyOf\":[{\"type\":\"string\"},{\"additionalProperties\":true,\"type\":\"object\"}],\"title\":\"Info\"}},\"required\":[\"info\"],\"title\":\"InfoEvent\",\"type\":\"object\"},\"JSONPatchEdit\":{\"description\":\"Edit that applies a JSON patch to the transcript.\",\"properties\":{\"operation\":{\"const\":\"json_patch\",\"default\":\"json_patch\",\"title\":\"Operation\",\"type\":\"string\"},\"patch\":{\"items\":{\"$ref\":\"#/$defs/JsonChange\"},\"title\":\"Patch\",\"type\":\"array\"},\"name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Name\"}},\"required\":[\"patch\"],\"title\":\"JSONPatchEdit\",\"type\":\"object\"},\"JSONSchema\":{\"description\":\"JSON Schema for type.\",\"properties\":{\"type\":{\"anyOf\":[{\"enum\":[\"string\",\"integer\",\"number\",\"boolean\",\"array\",\"object\",\"null\"],\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Type\"},\"format\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Format\"},\"description\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Description\"},\"default\":{\"default\":null,\"title\":\"Default\"},\"enum\":{\"anyOf\":[{\"items\":{},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Enum\"},\"items\":{\"anyOf\":[{\"$ref\":\"#/$defs/JSONSchema\"},{\"type\":\"null\"}],\"default\":null},\"properties\":{\"anyOf\":[{\"additionalProperties\":{\"$ref\":\"#/$defs/JSONSchema\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Properties\"},\"additionalProperties\":{\"anyOf\":[{\"$ref\":\"#/$defs/JSONSchema\"},{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Additionalproperties\"},\"anyOf\":{\"anyOf\":[{\"items\":{\"$ref\":\"#/$defs/JSONSchema\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Anyof\"},\"required\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Required\"}},\"title\":\"JSONSchema\",\"type\":\"object\"},\"JsonChange\":{\"description\":\"Describes a change to data using JSON Patch format.\",\"properties\":{\"op\":{\"enum\":[\"remove\",\"add\",\"replace\",\"move\",\"test\",\"copy\"],\"title\":\"Op\",\"type\":\"string\"},\"path\":{\"title\":\"Path\",\"type\":\"string\"},\"from\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"From\"},\"value\":{\"$ref\":\"#/$defs/JsonValue\",\"default\":null},\"replaced\":{\"$ref\":\"#/$defs/JsonValue\",\"default\":null}},\"required\":[\"op\",\"path\"],\"title\":\"JsonChange\",\"type\":\"object\"},\"JsonValue\":{},\"JudgeOutput\":{\"description\":\"Output from the alignment judge evaluation.\",\"properties\":{\"response\":{\"title\":\"Response\",\"type\":\"string\"},\"summary\":{\"title\":\"Summary\",\"type\":\"string\"},\"justification\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Justification\"},\"scores\":{\"additionalProperties\":{\"type\":\"integer\"},\"title\":\"Scores\",\"type\":\"object\"},\"score_descriptions\":{\"anyOf\":[{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Score Descriptions\"}},\"required\":[\"response\",\"summary\",\"scores\"],\"title\":\"JudgeOutput\",\"type\":\"object\"},\"Reset\":{\"description\":\"Edit that resets the transcript to the initial state.\",\"properties\":{\"operation\":{\"const\":\"reset\",\"default\":\"reset\",\"title\":\"Operation\",\"type\":\"string\"},\"new_messages\":{\"items\":{\"discriminator\":{\"mapping\":{\"assistant\":\"#/$defs/ChatMessageAssistant\",\"system\":\"#/$defs/ChatMessageSystem\",\"tool\":\"#/$defs/ChatMessageTool\",\"user\":\"#/$defs/ChatMessageUser\"},\"propertyName\":\"role\"},\"oneOf\":[{\"$ref\":\"#/$defs/ChatMessageSystem\"},{\"$ref\":\"#/$defs/ChatMessageUser\"},{\"$ref\":\"#/$defs/ChatMessageAssistant\"},{\"$ref\":\"#/$defs/ChatMessageTool\"}]},\"title\":\"New Messages\",\"type\":\"array\"}},\"title\":\"Reset\",\"type\":\"object\"},\"Rollback\":{\"description\":\"Edit that rolls back the transcript count messages.\",\"properties\":{\"operation\":{\"const\":\"rollback\",\"default\":\"rollback\",\"title\":\"Operation\",\"type\":\"string\"},\"count\":{\"minimum\":0,\"title\":\"Count\",\"type\":\"integer\"},\"to_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"To Id\"}},\"required\":[\"count\"],\"title\":\"Rollback\",\"type\":\"object\"},\"ToolCall\":{\"properties\":{\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"function\":{\"title\":\"Function\",\"type\":\"string\"},\"arguments\":{\"additionalProperties\":true,\"title\":\"Arguments\",\"type\":\"object\"},\"internal\":{\"anyOf\":[{\"$ref\":\"#/$defs/JsonValue\"},{\"type\":\"null\"}],\"default\":null},\"parse_error\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Parse Error\"},\"view\":{\"anyOf\":[{\"$ref\":\"#/$defs/ToolCallContent\"},{\"type\":\"null\"}],\"default\":null},\"type\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Type\"}},\"required\":[\"id\",\"function\",\"arguments\"],\"title\":\"ToolCall\",\"type\":\"object\"},\"ToolCallContent\":{\"description\":\"Content to include in tool call view.\",\"properties\":{\"title\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Title\"},\"format\":{\"enum\":[\"text\",\"markdown\"],\"title\":\"Format\",\"type\":\"string\"},\"content\":{\"title\":\"Content\",\"type\":\"string\"}},\"required\":[\"format\",\"content\"],\"title\":\"ToolCallContent\",\"type\":\"object\"},\"ToolCallError\":{\"properties\":{\"type\":{\"enum\":[\"parsing\",\"timeout\",\"unicode_decode\",\"permission\",\"file_not_found\",\"is_a_directory\",\"limit\",\"approval\",\"unknown\",\"output_limit\"],\"title\":\"Type\",\"type\":\"string\"},\"message\":{\"title\":\"Message\",\"type\":\"string\"}},\"required\":[\"type\",\"message\"],\"title\":\"ToolCallError\",\"type\":\"object\"},\"ToolCreationEvent\":{\"description\":\"Event that creates a tool.\",\"properties\":{\"type\":{\"const\":\"tool_creation_event\",\"default\":\"tool_creation_event\",\"title\":\"Type\",\"type\":\"string\"},\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"title\":\"Metadata\"},\"timestamp\":{\"format\":\"date-time\",\"title\":\"Timestamp\",\"type\":\"string\"},\"model\":{\"title\":\"Model\",\"type\":\"string\"},\"tool\":{\"$ref\":\"#/$defs/ToolDefinition\"}},\"required\":[\"model\",\"tool\"],\"title\":\"ToolCreationEvent\",\"type\":\"object\"},\"ToolDefinition\":{\"description\":\"Serializable representation of a tool definition.\\\\n\\\\nThis holds only JSON-serializable fields. Convert to the library\\'s\\\\nInspect `ToolDef` with `to_inspect_tooldef()` when calling model.generate.\",\"properties\":{\"name\":{\"title\":\"Name\",\"type\":\"string\"},\"description\":{\"title\":\"Description\",\"type\":\"string\"},\"parameters\":{\"$ref\":\"#/$defs/ToolParams\"},\"parallel\":{\"default\":true,\"title\":\"Parallel\",\"type\":\"boolean\"},\"options\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Options\"},\"viewer\":{\"default\":null,\"title\":\"Viewer\"},\"model_input\":{\"default\":null,\"title\":\"Model Input\"}},\"required\":[\"name\",\"description\",\"parameters\"],\"title\":\"ToolDefinition\",\"type\":\"object\"},\"ToolParams\":{\"description\":\"Description of tool parameters object in JSON Schema format.\",\"properties\":{\"type\":{\"const\":\"object\",\"default\":\"object\",\"title\":\"Type\",\"type\":\"string\"},\"properties\":{\"type\":\"object\",\"additionalProperties\":{\"$ref\":\"#/$defs/JSONSchema\"},\"title\":\"Properties\"},\"required\":{\"items\":{\"type\":\"string\"},\"title\":\"Required\",\"type\":\"array\"},\"additionalProperties\":{\"default\":false,\"title\":\"Additionalproperties\",\"type\":\"boolean\"}},\"title\":\"ToolParams\",\"type\":\"object\"},\"TranscriptEvent\":{\"description\":\"Event that modifies a transcript.\\\\n\\\\nThe view field determines which transcript view(s) this event should be applied to.\\\\nCan be a single view name or a list of view names.\",\"properties\":{\"type\":{\"const\":\"transcript_event\",\"default\":\"transcript_event\",\"title\":\"Type\",\"type\":\"string\"},\"id\":{\"title\":\"Id\",\"type\":\"string\"},\"metadata\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"title\":\"Metadata\"},\"timestamp\":{\"format\":\"date-time\",\"title\":\"Timestamp\",\"type\":\"string\"},\"view\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}],\"title\":\"View\"},\"edit\":{\"discriminator\":{\"mapping\":{\"add\":\"#/$defs/AddMessage\",\"json_patch\":\"#/$defs/JSONPatchEdit\",\"reset\":\"#/$defs/Reset\",\"rollback\":\"#/$defs/Rollback\"},\"propertyName\":\"operation\"},\"oneOf\":[{\"$ref\":\"#/$defs/AddMessage\"},{\"$ref\":\"#/$defs/Rollback\"},{\"$ref\":\"#/$defs/Reset\"},{\"$ref\":\"#/$defs/JSONPatchEdit\"}],\"title\":\"Edit\"}},\"required\":[\"view\",\"edit\"],\"title\":\"TranscriptEvent\",\"type\":\"object\"},\"TranscriptMetadata\":{\"properties\":{\"transcript_id\":{\"title\":\"Transcript Id\",\"type\":\"string\"},\"auditor_model\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Auditor Model\"},\"target_model\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Target Model\"},\"created_at\":{\"format\":\"date-time\",\"title\":\"Created At\",\"type\":\"string\"},\"updated_at\":{\"format\":\"date-time\",\"title\":\"Updated At\",\"type\":\"string\"},\"version\":{\"const\":\"v3.0\",\"default\":\"v3.0\",\"title\":\"Version\",\"type\":\"string\"},\"description\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Description\"},\"tags\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"title\":\"Tags\"},\"judge_output\":{\"anyOf\":[{\"$ref\":\"#/$defs/JudgeOutput\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"transcript_id\",\"created_at\",\"updated_at\"],\"title\":\"TranscriptMetadata\",\"type\":\"object\"},\"UrlCitation\":{\"description\":\"A citation that refers to a URL.\",\"properties\":{\"cited_text\":{\"anyOf\":[{\"type\":\"string\"},{\"additionalItems\":false,\"items\":[{\"type\":\"integer\"},{\"type\":\"integer\"}],\"maxItems\":2,\"minItems\":2,\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Cited Text\"},\"title\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Title\"},\"internal\":{\"anyOf\":[{\"additionalProperties\":{\"$ref\":\"#/$defs/JsonValue\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null,\"title\":\"Internal\"},\"type\":{\"const\":\"url\",\"default\":\"url\",\"title\":\"Type\",\"type\":\"string\"},\"url\":{\"title\":\"Url\",\"type\":\"string\"}},\"required\":[\"url\"],\"title\":\"UrlCitation\",\"type\":\"object\"}}');\nconst properties = { \"metadata\": { \"$ref\": \"#/$defs/TranscriptMetadata\" }, \"events\": { \"items\": { \"discriminator\": { \"mapping\": { \"decision_event\": \"#/$defs/DecisionEvent\", \"info_event\": \"#/$defs/InfoEvent\", \"tool_creation_event\": \"#/$defs/ToolCreationEvent\", \"transcript_event\": \"#/$defs/TranscriptEvent\" }, \"propertyName\": \"type\" }, \"oneOf\": [{ \"$ref\": \"#/$defs/TranscriptEvent\" }, { \"$ref\": \"#/$defs/ToolCreationEvent\" }, { \"$ref\": \"#/$defs/InfoEvent\" }, { \"$ref\": \"#/$defs/DecisionEvent\" }] }, \"title\": \"Events\", \"type\": \"array\" }, \"messages\": { \"items\": {}, \"title\": \"Messages\", \"type\": \"array\" }, \"target_messages\": { \"items\": {}, \"title\": \"Target Messages\", \"type\": \"array\" } };\nconst required = [\"metadata\"];\nconst title = \"Transcript\";\nconst type = \"object\";\nconst transcriptSchema = {\n  $defs,\n  properties,\n  required,\n  title,\n  type\n};\nconst ajv = new Ajv({\n  allErrors: true,\n  // Collect all errors, not just the first one\n  verbose: true,\n  // Include schema and data information in errors\n  strict: false\n  // Allow unknown keywords (for Pydantic-generated schemas)\n});\naddFormats(ajv);\najv.addFormat(\"date-time\", {\n  type: \"string\",\n  validate: function(dateTimeString) {\n    if (/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(Z|[+-]\\d{2}:\\d{2})?$/.test(dateTimeString)) {\n      return !isNaN(Date.parse(dateTimeString));\n    }\n    if (/^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?(?:Z|[+-]\\d{2}:\\d{2})?$/.test(dateTimeString)) {\n      const normalized = dateTimeString.replace(\" \", \"T\");\n      return !isNaN(Date.parse(normalized));\n    }\n    return false;\n  }\n});\nconst validateTranscript = ajv.compile(transcriptSchema);\nfunction jsonPointerToPath(pointer) {\n  if (!pointer || pointer === \"/\") return \"root\";\n  const parts = pointer.split(\"/\").filter(Boolean).map(decodeURIComponent);\n  let path2 = \"\";\n  for (const part of parts) {\n    const isIndex = /^\\d+$/.test(part);\n    if (path2 === \"\") {\n      path2 = isIndex ? `[${part}]` : part;\n    } else if (isIndex) {\n      path2 += `[${part}]`;\n    } else {\n      path2 += `.${part}`;\n    }\n  }\n  return path2 || \"root\";\n}\nfunction validateTranscriptData(data) {\n  const valid = validateTranscript(data);\n  if (valid) {\n    return {\n      isValid: true,\n      valid: true,\n      errors: [],\n      transcript: data,\n      data\n    };\n  }\n  const errors = (validateTranscript.errors || []).map((error) => {\n    let message = error.message || \"Unknown validation error\";\n    if (error.keyword === \"required\" && error.params?.missingProperty) {\n      message = `missing required property \"${error.params.missingProperty}\"`;\n    } else if (error.keyword === \"const\" && error.params?.allowedValue !== void 0) {\n      message = `must be equal to constant (${JSON.stringify(error.params.allowedValue)})`;\n    }\n    return {\n      message,\n      path: jsonPointerToPath(error.instancePath || error.schemaPath || \"\"),\n      value: error.data,\n      schema: error.schema,\n      keyword: error.keyword,\n      params: error.params,\n      schemaPath: error.schemaPath\n    };\n  });\n  const partialData = extractTranscriptInfo(data);\n  return {\n    isValid: false,\n    valid: false,\n    errors,\n    partialData,\n    data\n  };\n}\nfunction formatValidationErrors(errors) {\n  if (errors.length === 0) return \"No validation errors\";\n  const errorMessages = errors.map((error, index) => {\n    const path2 = error.path || \"root\";\n    let valueSnippet = \"\";\n    try {\n      const json = JSON.stringify(error.value);\n      if (json && json.length <= 80) valueSnippet = ` (value: ${json})`;\n    } catch {\n    }\n    return `${index + 1}. ${path2}: ${error.message}${valueSnippet}`;\n  });\n  return `Schema validation failed (${errors.length} error${errors.length === 1 ? \"\" : \"s\"}):\n${errorMessages.join(\"\\n\")}`;\n}\nfunction validateAndParseTranscript(content, filename) {\n  try {\n    const data = JSON.parse(content);\n    const result = validateTranscriptData(data);\n    if (!result.valid) {\n      console.error(\n        `Transcript validation failed${filename ? ` for ${filename}` : \"\"}:\n` + formatValidationErrors(result.errors)\n      );\n    }\n    return result;\n  } catch (parseError) {\n    return {\n      isValid: false,\n      valid: false,\n      errors: [{\n        message: `JSON parsing failed: ${parseError instanceof Error ? parseError.message : \"Unknown parse error\"}`,\n        path: \"root\",\n        value: content,\n        schema: null\n      }],\n      data: null\n    };\n  }\n}\nfunction extractTranscriptInfo(data) {\n  return {\n    hasMetadata: !!(data && data.metadata),\n    hasEvents: !!(data && Array.isArray(data.events)),\n    eventCount: data && Array.isArray(data.events) ? data.events.length : 0,\n    version: data?.metadata?.version || null,\n    sessionId: data?.metadata?.session_id || null\n  };\n}\nif (typeof window !== \"undefined\") {\n  throw new Error(\"transcript-loader can only be used on the server side\");\n}\nasync function loadTranscriptFromFile(filePath) {\n  try {\n    const content = await promises.readFile(filePath, \"utf-8\");\n    const validationResult = validateAndParseTranscript(content, path.basename(filePath));\n    if (!validationResult.valid) {\n      const details = formatValidationErrors(validationResult.errors);\n      const err = new Error(`Invalid transcript file: ${filePath}\n${details}`);\n      err.code = \"TRANSCRIPT_VALIDATION_FAILED\";\n      err.validation = validationResult;\n      throw err;\n    }\n    const transcript = validationResult.data;\n    if (!transcript.metadata?.transcript_id) {\n      throw new Error(`Missing transcript_id in metadata for file: ${filePath}`);\n    }\n    return createTranscriptDisplay(transcript, filePath);\n  } catch (error) {\n    if (error.code === \"ENOENT\") {\n      return null;\n    }\n    throw new Error(`Failed to load transcript from ${filePath}: ${error.message}`);\n  }\n}\nasync function loadMetadataFromFile(filePath) {\n  try {\n    const content = await promises.readFile(filePath, \"utf-8\");\n    const data = JSON.parse(content);\n    if (!data?.metadata) {\n      throw new Error(`Invalid transcript structure in ${filePath}: missing metadata`);\n    }\n    return data.metadata;\n  } catch (error) {\n    if (error.code === \"ENOENT\") {\n      return null;\n    }\n    if (error instanceof SyntaxError) {\n      throw new Error(`Invalid JSON in ${filePath}: ${error.message}`);\n    }\n    throw new Error(`Failed to load metadata from ${filePath}: ${error.message}`);\n  }\n}\nconst TRANSCRIPT_DIR = path.resolve(process.env.TRANSCRIPT_DIR || DEFAULT_TRANSCRIPT_DIR);\nconsole.log(`[CONFIG] Transcript directory resolved to: ${TRANSCRIPT_DIR}`);\nif (typeof window !== \"undefined\") {\n  throw new Error(\"transcript-cache can only be used on the server side\");\n}\nclass TranscriptCache {\n  metadataCache = /* @__PURE__ */ new Map();\n  fullTranscriptCache = /* @__PURE__ */ new Map();\n  maxFullTranscripts;\n  watcherInitialized = false;\n  watcher = null;\n  changeEmitter = new EventEmitter();\n  versionToken = `${Date.now()}`;\n  stats = {\n    metadataCount: 0,\n    fullTranscriptCount: 0,\n    cacheHits: 0,\n    cacheMisses: 0,\n    fileWatcherActive: false\n  };\n  constructor(maxFullTranscripts = 200) {\n    this.maxFullTranscripts = maxFullTranscripts;\n    console.log(`üóÑÔ∏è [CACHE] TranscriptCache initialized with max ${maxFullTranscripts} full transcripts`);\n  }\n  /**\n   * Initialize file system watcher for the transcript directory\n   */\n  async initializeWatcher(transcriptDir = DEFAULT_TRANSCRIPT_DIR) {\n    if (this.watcherInitialized) {\n      console.log(\"üîç [CACHE] File watcher already initialized\");\n      return;\n    }\n    try {\n      await promises.access(transcriptDir);\n      console.log(`üîç [CACHE] Initializing file watcher for: ${transcriptDir}`);\n      this.watcher = watch(path.join(transcriptDir, \"**/*.json\"), {\n        ignored: /(^|[\\/\\\\])\\../,\n        // ignore dotfiles\n        persistent: true,\n        ignoreInitial: true\n        // Don't trigger for existing files\n      });\n      this.watcher.on(\"add\", (filePath) => {\n        console.log(`üìÑ [CACHE] File added: ${filePath}`);\n        this.bumpVersionAndEmit(\"add\", filePath);\n        this.invalidateFile(filePath);\n      }).on(\"change\", (filePath) => {\n        console.log(`üìù [CACHE] File changed: ${filePath}`);\n        this.bumpVersionAndEmit(\"change\", filePath);\n        this.invalidateFile(filePath);\n      }).on(\"unlink\", (filePath) => {\n        console.log(`üóëÔ∏è [CACHE] File deleted: ${filePath}`);\n        this.bumpVersionAndEmit(\"unlink\", filePath);\n        this.invalidateFile(filePath);\n      }).on(\"error\", (error) => {\n        console.error(\"üö® [CACHE] File watcher error:\", error);\n      }).on(\"ready\", () => {\n        console.log(\"‚úÖ [CACHE] File watcher is ready\");\n        this.stats.fileWatcherActive = true;\n      });\n      this.watcherInitialized = true;\n    } catch (error) {\n      console.error(`üö® [CACHE] Failed to initialize file watcher for ${transcriptDir}:`, error);\n    }\n  }\n  /**\n   * Increment version token and emit a structured change event\n   */\n  bumpVersionAndEmit(eventType, absoluteFilePath) {\n    this.versionToken = `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n    let relativePath;\n    try {\n      const baseDir = TRANSCRIPT_DIR;\n      relativePath = path.relative(baseDir, absoluteFilePath);\n    } catch {\n      relativePath = absoluteFilePath;\n    }\n    this.changeEmitter.emit(\"change\", {\n      type: eventType,\n      absolutePath: absoluteFilePath,\n      relativePath,\n      version: this.versionToken,\n      updatedAt: Date.now()\n    });\n  }\n  /**\n   * Get metadata from cache or load from file\n   */\n  async getMetadata(filePath) {\n    const normalizedPath = path.normalize(filePath);\n    const cached = this.metadataCache.get(normalizedPath);\n    if (cached && await this.isCacheValid(cached)) {\n      cached.accessTime = Date.now();\n      this.stats.cacheHits++;\n      return cached.data;\n    }\n    this.stats.cacheMisses++;\n    const metadata = await loadMetadataFromFile(normalizedPath);\n    if (metadata === null) {\n      return null;\n    }\n    const stat = await promises.stat(normalizedPath);\n    this.metadataCache.set(normalizedPath, {\n      data: metadata,\n      filePath: normalizedPath,\n      lastModified: stat.mtime.getTime(),\n      accessTime: Date.now()\n    });\n    this.stats.metadataCount = this.metadataCache.size;\n    return metadata;\n  }\n  /**\n   * Get full transcript from cache or load from file\n   */\n  async getFullTranscript(filePath) {\n    const normalizedPath = path.normalize(filePath);\n    const cached = this.fullTranscriptCache.get(normalizedPath);\n    if (cached && await this.isCacheValid(cached)) {\n      cached.accessTime = Date.now();\n      this.stats.cacheHits++;\n      console.log(`üíæ [CACHE] Full transcript cache hit: ${normalizedPath}`);\n      return cached.data;\n    }\n    console.log(`üìÅ [CACHE] Loading full transcript from file: ${normalizedPath}`);\n    this.stats.cacheMisses++;\n    const transcript = await loadTranscriptFromFile(normalizedPath);\n    if (transcript === null) {\n      return null;\n    }\n    const absoluteBaseDir = TRANSCRIPT_DIR;\n    const relativePath = path.relative(absoluteBaseDir, normalizedPath).replace(/\\\\/g, \"/\");\n    const updatedTranscript = {\n      ...transcript,\n      _filePath: relativePath\n    };\n    const stat = await promises.stat(normalizedPath);\n    const entry = {\n      data: updatedTranscript,\n      filePath: normalizedPath,\n      lastModified: stat.mtime.getTime(),\n      accessTime: Date.now()\n    };\n    this.fullTranscriptCache.set(normalizedPath, entry);\n    await this.enforceFullTranscriptLimit();\n    this.stats.fullTranscriptCount = this.fullTranscriptCache.size;\n    return updatedTranscript;\n  }\n  /**\n   * Check if a cached entry is still valid by comparing modification times\n   */\n  async isCacheValid(cached) {\n    try {\n      const stat = await promises.stat(cached.filePath);\n      return cached.lastModified >= stat.mtime.getTime();\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Enforce LRU eviction for full transcript cache\n   */\n  async enforceFullTranscriptLimit() {\n    if (this.fullTranscriptCache.size <= this.maxFullTranscripts) {\n      return;\n    }\n    const entries = Array.from(this.fullTranscriptCache.entries());\n    entries.sort(([, a], [, b]) => a.accessTime - b.accessTime);\n    const toRemove = entries.slice(0, entries.length - this.maxFullTranscripts);\n    for (const [key] of toRemove) {\n      this.fullTranscriptCache.delete(key);\n      console.log(`üóëÔ∏è [CACHE] Evicted full transcript from cache: ${key}`);\n    }\n    console.log(`üìä [CACHE] LRU eviction completed. Full transcript cache size: ${this.fullTranscriptCache.size}`);\n  }\n  /**\n   * Invalidate cache entries for a specific file\n   */\n  invalidateFile(filePath) {\n    const normalizedPath = path.normalize(filePath);\n    let invalidated = false;\n    if (this.metadataCache.has(normalizedPath)) {\n      this.metadataCache.delete(normalizedPath);\n      invalidated = true;\n      console.log(`üóëÔ∏è [CACHE] Invalidated metadata cache for: ${normalizedPath}`);\n    }\n    if (this.fullTranscriptCache.has(normalizedPath)) {\n      this.fullTranscriptCache.delete(normalizedPath);\n      invalidated = true;\n      console.log(`üóëÔ∏è [CACHE] Invalidated full transcript cache for: ${normalizedPath}`);\n    }\n    if (invalidated) {\n      this.updateStats();\n    }\n  }\n  /**\n   * Subscribe to change events (file add/change/delete)\n   */\n  onChange(listener) {\n    this.changeEmitter.on(\"change\", listener);\n    return () => this.changeEmitter.off(\"change\", listener);\n  }\n  /**\n   * Get current version token that changes whenever any transcript file changes\n   */\n  getVersion() {\n    return this.versionToken;\n  }\n  /**\n   * Clear all cache entries\n   */\n  clearCache() {\n    const metadataCount = this.metadataCache.size;\n    const fullTranscriptCount = this.fullTranscriptCache.size;\n    this.metadataCache.clear();\n    this.fullTranscriptCache.clear();\n    this.updateStats();\n    console.log(`üóëÔ∏è [CACHE] Cleared all cache entries (${metadataCount} metadata, ${fullTranscriptCount} full transcripts)`);\n  }\n  /**\n   * Get cache statistics\n   */\n  getStats() {\n    return { ...this.stats };\n  }\n  /**\n   * Update internal statistics\n   */\n  updateStats() {\n    this.stats.metadataCount = this.metadataCache.size;\n    this.stats.fullTranscriptCount = this.fullTranscriptCache.size;\n  }\n  /**\n   * Shutdown the cache and cleanup resources\n   */\n  async shutdown() {\n    if (this.watcher) {\n      console.log(\"üîç [CACHE] Shutting down file watcher\");\n      await this.watcher.close();\n      this.watcher = null;\n      this.stats.fileWatcherActive = false;\n    }\n    this.clearCache();\n    this.watcherInitialized = false;\n    console.log(\"üóÑÔ∏è [CACHE] TranscriptCache shutdown completed\");\n  }\n  /**\n   * Preload metadata for all files in a directory (for bulk operations)\n   */\n  async preloadMetadata(transcriptDir = DEFAULT_TRANSCRIPT_DIR) {\n    console.log(`üîÑ [CACHE] Preloading metadata from: ${transcriptDir}`);\n    try {\n      const files = await this.findAllTranscriptFiles(transcriptDir);\n      console.log(`üìÅ [CACHE] Found ${files.length} transcript files to preload`);\n      const concurrency = 10;\n      const chunks = this.chunkArray(files, concurrency);\n      for (const chunk of chunks) {\n        await Promise.all(\n          chunk.map(async (filePath) => {\n            try {\n              await this.getMetadata(filePath);\n            } catch (error) {\n              console.warn(`‚ö†Ô∏è [CACHE] Failed to preload metadata for ${filePath}:`, error);\n            }\n          })\n        );\n      }\n      console.log(`‚úÖ [CACHE] Preloaded metadata for ${this.metadataCache.size} transcripts`);\n    } catch (error) {\n      console.error(\"üö® [CACHE] Failed to preload metadata:\", error);\n    }\n  }\n  /**\n   * Find all transcript files recursively\n   */\n  async findAllTranscriptFiles(dir) {\n    const files = [];\n    async function scanDir(currentDir) {\n      const entries = await promises.readdir(currentDir, { withFileTypes: true });\n      for (const entry of entries) {\n        const fullPath = path.join(currentDir, entry.name);\n        if (entry.isDirectory()) {\n          await scanDir(fullPath);\n        } else if (entry.isFile() && entry.name.endsWith(\".json\")) {\n          files.push(fullPath);\n        }\n      }\n    }\n    await scanDir(dir);\n    return files;\n  }\n  /**\n   * Utility function to chunk an array\n   */\n  chunkArray(array, chunkSize) {\n    const chunks = [];\n    for (let i = 0; i < array.length; i += chunkSize) {\n      chunks.push(array.slice(i, i + chunkSize));\n    }\n    return chunks;\n  }\n}\nlet globalCache = null;\nfunction getTranscriptCache() {\n  if (!globalCache) {\n    globalCache = new TranscriptCache();\n  }\n  return globalCache;\n}\nasync function initializeGlobalCache(transcriptDir) {\n  const cache = getTranscriptCache();\n  await cache.initializeWatcher(transcriptDir);\n}\nasync function shutdownGlobalCache() {\n  if (globalCache) {\n    await globalCache.shutdown();\n    globalCache = null;\n  }\n}\nconst transcriptCache = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  TranscriptCache,\n  getTranscriptCache,\n  initializeGlobalCache,\n  shutdownGlobalCache\n}, Symbol.toStringTag, { value: \"Module\" }));\nexport {\n  TRANSCRIPT_DIR as T,\n  getTranscriptCache as g,\n  initializeGlobalCache as i,\n  shutdownGlobalCache as s,\n  transcriptCache as t\n};\n"],"names":[],"mappings":"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"}